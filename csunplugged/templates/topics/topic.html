{% extends "base_columns.html" %}

{% load render_html_field %}
{% load django_bootstrap_breadcrumbs %}

{% block breadcrumbs %}
  {% breadcrumb "Home" "/" %}
  {% breadcrumb "Topics" "topics:index" %}
  {% breadcrumb topic.name "topics:topic" topic.slug %}
{% endblock breadcrumbs %}

{% block page_heading %}
  <h1 class="heading-underline">{{ topic.name }}</h1>
{% endblock page_heading %}

{% block left_column_content %}
  {% render_html_field topic.content %}

  {% for unit_plan in unit_plans %}
    <div class="boxed-text">
      <div class="boxed-text-content">
        <h2>
          <a href="{% url 'topics:unit_plan' topic.slug unit_plan.slug %}">
            {{ unit_plan.name }}
          </a>
        </h2>

        {% if unit_plan.unit_plan_lessons %}
          {% for age_range, lessons in unit_plan.lessons.items %}
            <h3>
              Lessons for Ages {{ age_range.0 }} to {{ age_range.1 }}
            </h3>

            <ul>
              {% for lesson in lessons %}
                <li>
                  <a href="{% url 'topics:lesson' topic.slug unit_plan.slug lesson.slug %}">
                    <strong>Lesson {{ lesson.number }}:</strong> {{ lesson.name }}
                  </a>
                  {% if lesson.has_programming_exercises %}
                    <ul>
                      <li>
                        <a href="{% url 'topics:programming_exercises_list' topic.slug unit_plan.slug lesson.slug %}">
                          View Lesson Programming Challenges
                        </a>
                      </li>
                    </ul>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% endfor %}
        {% endif %}
      </div>
    </div>
  {% endfor %}

  <h2 class="heading-underline">Curriculum Integrations</h2>
  {% if curriculum_integrations %}
    {% for integration in curriculum_integrations %}
      <ul class="list-unstyled">
        <li>
          <p>
            <a href="{% url 'topics:integration' topic.slug integration.slug %}">
              <strong>{{ integration.name }}</strong>
            </a>
            {% for area in integration.curriculum_areas.all %}
              {% include "topics/curriculum_area_badge.html" %}
            {% endfor %}
          </p>
        </li>
      </ul>
    {% endfor %}
  {% else %}
    <p>No curriculum integrations for {{ topic }}.</p>
  {% endif %}

  <h2 class="heading-underline">Programming Challenges</h2>
  {% if programming_exercises %}
    <ul>
      {% for programming_exercise in programming_exercises %}
        <li>
          <a href="{% url 'topics:programming_exercise' topic.slug programming_exercise.slug %}">
            {{ programming_exercise.exercise_set_number }}.{{ programming_exercise.exercise_number }}
            {{ programming_exercise.name }}
          </a>
          {% include "topics/programming_difficulty_badge.html" %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No programming challenges for {{ topic }}.</p>
  {% endif %}

  {% if topic.other_resources %}
    <h2 class="heading-underline">Looking for more?</h2>
    <p>
      <a href="{% url 'topics:other_resources' topic.slug %}">
        Click here for other resources
      </a>
    </p>
  {% endif %}
{% endblock left_column_content %}
