{% extends "base.html" %}

{% load i18n %}
{% load static %}
{% load render_html_field %}
{% load django_bootstrap_breadcrumbs %}

{% block title %}
  {{ topic.name }}
{% endblock title %}

{% block breadcrumbs %}
  {% breadcrumb "Home" "/" %}
  {% breadcrumb "Topics" "topics:index" %}
  {% breadcrumb topic.name "topics:topic" topic.slug %}
{% endblock breadcrumbs %}

{% block page_heading %}
  <h1 id="{{ topic.slug }}" class="heading-underline">{{ topic.name }}</h1>
  {% if not topic.translation_available %}
    {% trans "topic" as topic_l10n %}
    {% trans "list of topics" as list_of_topics_l10n %}
    {% url "topics:index" as parent_url %}
    {% with model=topic model_type=topic_l10n parent_type=list_of_topics_l10n parent_url=parent_url %}
      {% include 'topics/not-available-warning.html' %}
    {% endwith %}
  {% endif %}
{% endblock page_heading %}

{% block content %}
  {% if topic.translation_available %}
    {% render_html_field topic.content %}

    <h2 class="heading-underline">{% trans "Units" %}</h2>
    <div class="row">
      {% for unit_plan in unit_plans %}
        <a class="col-12 col-md-8 col-lg-6 link-item no-text-decoration py-4 align-items-center{% if not unit_plan.translation_available %} unavailable{% endif %}" href="{% url 'topics:unit_plan' topic.slug unit_plan.slug %}">
          {% if not unit_plan.translation_available %}
            {% include "topics/not-available-badge.html" %}
          {% endif %}
          <h3>{{ unit_plan.name }}</h3>
          <ul class="list-unstyled text-muted mb-0">
            {% if unit_plan.lessons.exists %}
              <li>
                <strong>
                  {% blocktrans trimmed with min_age=unit_plan.min_age max_age=unit_plan.max_age%}
                    Ages {{ min_age }} to {{ max_age }}
                  {% endblocktrans %}
                </strong>
              </li>
              <li>
                {{ unit_plan.lessons.count }} {% trans "lessons" %}
              </li>
            {% endif %}
            {% if unit_plan.programming_challenges.exists %}
              <li>{{ unit_plan.programming_challenges.count }} {% trans "programming challenges" %}</li>
            {% endif %}
          </ul>
        </a>
      {% endfor %}
    </div>

    {% if curriculum_integrations %}
    <h2 id="integrations" class="heading-underline">{% trans "Curriculum Integrations" %}</h2>
      {% include "topics/curriculum-integrations-table.html" %}
    {% endif %}

    {% if resources %}
    <h2 id="resources" class="heading-underline">{% trans "Resources" %}</h2>
      <p>
        {% blocktrans with name=topic.name trimmed %}
          The following resources are used in {{ name }} lessons, and can be accessed here (and also on each lesson page).
        {% endblocktrans %}
      </p>
      <div class="link-box-container">
        {% for resource in resources %}
          <a href="{% url 'resources:resource' resource.slug %}" class="link-box link-box-md-3">
            <img class="border-thin" src="{% static resource.thumbnail_static_path %}" alt="Generic placeholder image">
            <strong>{{ resource.name }}</strong>
          </a>
        {% endfor %}
      </div>
    {% endif %}
    {% if topic.other_resources %}
      <h2 id="other-resources" class="heading-underline">{% trans "Looking for more?" %}</h2>
      <p>
        <a href="{% url 'topics:other_resources' topic.slug %}">
          {% trans "Click here for other resources" %}
        </a>
      </p>
    {% endif %}
  {% endif %}
{% endblock content %}
