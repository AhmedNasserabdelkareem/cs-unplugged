{% extends 'base.html' %}

{% load django_bootstrap_breadcrumbs %}

{% block title %}
  Search
{% endblock title %}

{% block breadcrumbs %}
  {% breadcrumb "Home" "/" %}
  {% breadcrumb "Search" "search:haystack_search" %}
{% endblock breadcrumbs %}

{% block page_heading %}
  <h2>Search</h2>
{% endblock page_heading %}

{% block content %}
  <form method="get" action=".">
    <table>
        {{ form.as_table }}
        <tr>
            <td>&nbsp;</td>
            <td>
                <input type="submit" value="Search">
            </td>
        </tr>
    </table>

    {% if object_list %}
        <h3>Results</h3>

        <p><em>Showing results {{ page_obj.start_index }} to {{ page_obj.end_index }} of {{ paginator.count }} results</em></p>

        {% for result in page_obj.object_list %}
            <p>
              {{ result.object.model_type }} -
                <a href="{{ result.object.get_absolute_url }}">
                  {{ result.object.name }}
                </a>
              {% if not DEPLOYED %}
                <small class="text-muted">{{ result.score|floatformat:3 }}</small>
              {% endif %}
            </p>
        {% empty %}
            <p>No results found.</p>
        {% endfor %}

        {% if page_obj.has_previous or page_obj.has_next %}
            <div>
                {% if page_obj.has_previous %}
                  <a href="?q={{ query }}&amp;page={{ page_obj.previous_page_number }}">&laquo; Previous page</a>
                {% endif %}
                {% if page_obj.has_previous and page_obj.has_next %}
                |
                {% endif %}
                {% if page_obj.has_next %}
                  <a href="?q={{ query }}&amp;page={{ page_obj.next_page_number }}">Next page &raquo;</a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        {# Show some example queries to run, maybe query syntax, something else? #}
    {% endif %}
  </form>
{% endblock content %}
